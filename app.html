<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pro-Draft Generator</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="no-print side-nav">
      <div
        class="sidebar-header"
        style="
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 20px;
        "
      >
        <div>
          <h2 style="margin: 0">Pro-Draft</h2>
          <p style="font-size: 12px; color: #64748b; margin: 4px 0 0 0">
            SequenceIT Team
          </p>
        </div>
      </div>

      <button class="tab-btn active" onclick="openTab(event, 'editor')">
        1. Proposal Editor
      </button>
      <button class="tab-btn" onclick="openTab(event, 'policy')">
        2. Company Policy
      </button>
      <button class="tab-btn" onclick="openTab(event, 'preview')">
        3. Final Preview
      </button>
      <button class="tab-btn" onclick="openTab(event, 'drafts')">
        4. Saved Drafts
      </button>
      <a
        class="tab-btn"
        href="ai-generator.html"
        style="display: block; text-decoration: none"
      >
        5. AI Generator
      </a>
      <hr />
      <button
        class="download-btn"
        style="
          background: linear-gradient(135deg, #10b981 0%, #059669 100%);
          margin-bottom: 10px;
        "
        onclick="startNewDraft()"
      >
        üìù New Draft
      </button>
      <button
        class="download-btn save-draft-btn"
        id="saveDraftBtn"
        onclick="saveDraft()"
      >
        üíæ Save Draft
      </button>
      <button
        class="download-btn"
        id="downloadBtn"
        onclick="downloadAndSave()"
        style="display: none"
      >
        üìÑ Download PDF
      </button>
      <button
        class="download-btn"
        style="
          background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
          margin-top: 10px;
        "
        onclick="logoutUser()"
      >
        üö™ Logout
      </button>
    </div>

    <main class="content-area">
      <div id="editor" class="tab-content active">
        <section class="config-panel">
          <h3>Logo Configuration</h3>
          <select id="logoLayout" onchange="updateLogoLayout()">
            <option value="split">Side-by-Side (Company & Client)</option>
            <option value="center">Center (Company Only)</option>
          </select>
          <div class="upload-group">
            <label
              >Our Logo: <input type="file" accept="image/*" id="ourLogoInput"
            /></label>
            <label id="clientLogoLabel"
              >Client Logo:
              <input type="file" accept="image/*" id="clientLogoInput"
            /></label>
          </div>
        </section>

        <div class="paper" id="printableProposal">
          <header id="mainHeader" class="layout-split">
            <div class="logo-box" id="ourLogoContainer">
              <img
                id="ourLogoImg"
                src="https://i.ibb.co.com/twQ8CFCP/a60bafaa-162f-4d1b-8fd0-70c5a8f9f839.jpg"
                alt="Our Logo"
              />
            </div>
            <div class="logo-box" id="clientLogoContainer">
              <img
                id="clientLogoImg"
                src="https://via.placeholder.com/100?text=CLIENT+LOGO"
                alt="Client Logo"
              />
            </div>
          </header>

          <div class="title-section">
            <input
              type="text"
              class="h1-input"
              placeholder="PROJECT TITLE HERE"
            />
            <p>Project Proposal by <strong>SequenceIT</strong></p>
          </div>

          <!-- ==========================================
               DOCUMENT CONTROL AND INFORMATION
               ========================================== -->
          <div class="printable-section">
            <h2 class="section-title">Document Control and Information</h2>

            <div class="grid-2-col">
              <div class="info-block">
                <label>Document ID:</label>
                <input
                  type="text"
                  id="documentIdField"
                  placeholder="Generating..."
                  readonly
                  style="
                    background: rgba(100, 116, 139, 0.1);
                    cursor: not-allowed;
                  "
                />

                <label>Document Owner:</label>
                <input type="text" placeholder="Your Name/Company" />
              </div>
              <div class="info-block">
                <label>Issue Date:</label>
                <input type="date" id="currentDate" />

                <label>Project Title:</label>
                <input type="text" placeholder="Project Name" />
              </div>
            </div>

            <div class="grid-2-col" style="margin-top: 10px">
              <div class="info-block">
                <label>Starting Date:</label>
                <input type="date" />
              </div>
              <div class="info-block">
                <label>Handover Date:</label>
                <input type="date" />
              </div>
            </div>

            <h3 class="sub-title">Document History</h3>
            <table id="historyTable">
              <thead>
                <tr>
                  <th>Version</th>
                  <th>Issue Date</th>
                  <th>Changes</th>
                  <th class="no-print">Action</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><input type="text" value="1.0" /></td>
                  <td><input type="date" /></td>
                  <td><input type="text" placeholder="Initial Draft" /></td>
                  <td class="no-print"></td>
                </tr>
              </tbody>
            </table>
            <button
              class="no-print add-row-btn"
              onclick="addRow('historyTable')"
            >
              + Add History Row
            </button>

            <h3 class="sub-title">Document Approval</h3>
            <table id="approvalTable">
              <thead>
                <tr>
                  <th>Role</th>
                  <th>Name</th>
                  <th>Signature</th>
                  <th>Date</th>
                  <th class="no-print">Action</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>
                    <input type="text" placeholder="e.g. Project Manager" />
                  </td>
                  <td><input type="text" /></td>
                  <td><div class="sig-line"></div></td>
                  <td><input type="date" /></td>
                  <td class="no-print"></td>
                </tr>
              </tbody>
            </table>
            <button
              class="no-print add-row-btn"
              onclick="addRow('approvalTable')"
            >
              + Add Approval Row
            </button>
          </div>

          <!-- ==========================================
               SECTION 4: EXECUTIVE SUMMARY
               SECTION 5: BACKGROUND AND HISTORY
               SECTION 6: REQUIREMENTS & PROPOSAL
               ========================================== -->
          <div class="printable-section">
            <h2 class="section-title">1. Executive Summary</h2>
            <textarea
              class="auto-expand"
              placeholder="Write your vision, goal, and timeframe here..."
            ></textarea>

            <h2 class="section-title">2. Background and History</h2>
            <textarea
              class="auto-expand"
              placeholder="Previous context or project origins..."
            ></textarea>

            <h2 class="section-title">3. Requirements</h2>
            <h3 class="sub-title">3.1 Business Problem and Opportunity</h3>
            <textarea class="auto-expand"></textarea>
            <h3 class="sub-title">3.2 Solution</h3>
            <textarea class="auto-expand"></textarea>
          </div>

          <!-- ==========================================
               SECTION 6: PROPOSAL (VISION & DELIVERABLES)
               ========================================== -->
          <div class="printable-section">
            <h2 class="section-title">4. Proposal</h2>
            <h3 class="sub-title">4.1 Vision and Goal</h3>
            <textarea
              class="auto-expand"
              placeholder="Describe the long-term vision..."
            ></textarea>

            <div class="no-print toggle-box">
              Include Deliverables?
              <select
                id="deliverablesToggle"
                onchange="toggleSection('deliverablesContent', this.value)"
              >
                <option value="no">No</option>
                <option value="yes">Yes</option>
              </select>
            </div>

            <div id="deliverablesNoText" class="no-section-text">
              Deliverables are not included in this proposal.
            </div>

            <div id="deliverablesContent" class="hidden-section">
              <h3 class="sub-title">4.2 Deliverables</h3>
              <table id="deliverablesTable">
                <thead>
                  <tr>
                    <th>Feature/Module</th>
                    <th>Description</th>
                    <th class="no-print">Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <input
                        type="text"
                        placeholder="e.g., User Authentication"
                      />
                    </td>
                    <td>
                      <input
                        type="text"
                        placeholder="Social login, OTP, etc."
                      />
                    </td>
                    <td class="no-print"></td>
                  </tr>
                </tbody>
              </table>
              <button
                class="no-print add-row-btn"
                onclick="addRow('deliverablesTable')"
              >
                + Add Deliverable
              </button>
            </div>
          </div>

          <!-- ==========================================
               SECTION 7: TIMEFRAME
               ========================================== -->
          <div class="printable-section">
            <h2 class="section-title">5. Timeframe</h2>
            <!--
            <textarea
              class="auto-expand"
              placeholder="General timeline notes (e.g., 105 days total)..."
            ></textarea>
            -->
            <p class="instruction-text">
              Timeframe details are provided in the table below.
            </p>
            <table id="timeframeTable">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Task Name</th>
                  <th>Duration (Days/Weeks)</th>
                  <th class="no-print">Action</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>1</td>
                  <td>
                    <input type="text" placeholder="UI/UX Design Phase" />
                  </td>
                  <td><input type="text" placeholder="20 Days" /></td>
                  <td class="no-print"></td>
                </tr>
              </tbody>
            </table>
            <button
              class="no-print add-row-btn"
              onclick="addRow('timeframeTable')"
            >
              + Add Task Row
            </button>
          </div>

          <!-- ==========================================
               SECTION 8: BUDGET PLANNING (INFRASTRUCTURE)
               ========================================== -->
          <div class="printable-section">
            <h2 class="section-title">6. Budget Planning (Infrastructure)</h2>
            <p class="instruction-text">
              Server costs, Domain, API subscriptions, etc.
            </p>
            <table id="infraTable" class="calc-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Task/Item Name</th>
                  <th>Qty</th>
                  <th>Cost</th>
                  <th>Currency</th>
                  <th class="no-print">Action</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>1</td>
                  <td><input type="text" placeholder="e.g. AWS Hosting" /></td>
                  <td>
                    <input
                      type="number"
                      value="1"
                      oninput="calculateTotals()"
                    />
                  </td>
                  <td>
                    <input
                      type="number"
                      class="cost-input"
                      value="0"
                      oninput="calculateTotals()"
                    />
                  </td>
                  <td>
                    <select onchange="calculateTotals()">
                      <option value="BDT">BDT (‡ß≥)</option>
                      <option value="USD">USD ($)</option>
                      <option value="EUR">EUR (‚Ç¨)</option>
                    </select>
                  </td>
                  <td class="no-print"></td>
                </tr>
              </tbody>
            </table>
            <button class="no-print add-row-btn" onclick="addRow('infraTable')">
              + Add Item
            </button>
            <div class="total-display">
              Total Infrastructure: <span id="totalInfra">0</span>
            </div>
          </div>

          <!-- ==========================================
               SECTION 7: BUDGET PLANNING (DEVELOPMENT COST)
               ========================================== -->
          <div class="printable-section">
            <h2 class="section-title">7. Budget Planning (Development Cost)</h2>
            <p class="instruction-text">
              Cost for coding, integration, and engineering.
            </p>
            <table id="devCostTable" class="calc-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Task Name</th>
                  <th>Cost</th>
                  <th>Currency</th>
                  <th class="no-print">Action</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>1</td>
                  <td>
                    <input type="text" placeholder="Backend Development" />
                  </td>
                  <td>
                    <input
                      type="number"
                      class="cost-input"
                      value="0"
                      oninput="calculateTotals()"
                    />
                  </td>
                  <td>
                    <select onchange="calculateTotals()">
                      <option>BDT</option>
                      <option>USD</option>
                      <option>EUR</option>
                    </select>
                  </td>
                  <td class="no-print"></td>
                </tr>
              </tbody>
            </table>
            <button
              class="no-print add-row-btn"
              onclick="addRow('devCostTable')"
            >
              + Add Row
            </button>
            <div class="total-display">
              Total Development: <span id="totalDev">0</span>
            </div>
          </div>

          <!-- ==========================================
               SECTION 8: MAINTENANCE
               ========================================== -->
          <div class="printable-section">
            <h2 class="section-title">8. Maintenance</h2>
            <div class="no-print toggle-box">
              Include Maintenance?
              <select
                id="maintToggle"
                onchange="toggleSection('maintContent', this.value)"
              >
                <option value="no">No</option>
                <option value="yes">Yes</option>
              </select>
            </div>

            <div id="maintNoText" class="no-section-text">
              Maintenance is not included in this proposal.
            </div>

            <div id="maintContent" class="hidden-section">
              <!-- <textarea placeholder="Describe maintenance terms..."></textarea> -->
              <p class="instruction-text">
                Maintenance details are provided in the table below.
              </p>
              <table id="maintTable" class="calc-table">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Service</th>
                    <th>Cost</th>
                    <th>Currency</th>
                    <th class="no-print">Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>1</td>
                    <td><input type="text" placeholder="Monthly Support" /></td>
                    <td>
                      <input
                        type="number"
                        class="cost-input"
                        value="0"
                        oninput="calculateTotals()"
                      />
                    </td>
                    <td>
                      <select onchange="calculateTotals()">
                        <option>BDT</option>
                        <option>USD</option>
                      </select>
                    </td>
                    <td class="no-print"></td>
                  </tr>
                </tbody>
              </table>
              <button
                class="no-print add-row-btn"
                onclick="addRow('maintTable')"
              >
                + Add Row
              </button>
            </div>
          </div>

          <!-- ==========================================
               SECTION 9: RISK CONTROL
               ========================================== -->
          <div class="printable-section">
            <h2 class="section-title">9. Risk Control</h2>
            <div class="no-print toggle-box">
              Include Risk Issue Coverage?
              <select
                id="riskToggle"
                onchange="toggleSection('riskContent', this.value)"
              >
                <option value="no">No</option>
                <option value="yes">Yes</option>
              </select>
            </div>

            <div id="riskNoText" class="no-section-text">
              Risk control coverage is not included in this proposal.
            </div>

            <div id="riskContent" class="hidden-section">
              <!--
              <textarea
                placeholder="Describe how risks will be managed..."
              ></textarea>
              -->
              <p class="instruction-text">
                Risk control details are provided in the table below.
              </p>
              <table id="riskTable" class="calc-table">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Risk Issue Name</th>
                    <th>Cost (Mitigation)</th>
                    <th>Currency</th>
                    <th class="no-print">Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>1</td>
                    <td>
                      <input
                        type="text"
                        placeholder="Server Downtime Insurance"
                      />
                    </td>
                    <td>
                      <input
                        type="number"
                        class="cost-input"
                        value="0"
                        oninput="calculateTotals()"
                      />
                    </td>
                    <td>
                      <select onchange="calculateTotals()">
                        <option>BDT</option>
                        <option>USD</option>
                      </select>
                    </td>
                    <td class="no-print"></td>
                  </tr>
                </tbody>
              </table>
              <button
                class="no-print add-row-btn"
                onclick="addRow('riskTable')"
              >
                + Add Row
              </button>
            </div>
          </div>

          <!-- ==========================================
               SECTION 10: OVERALL BUDGET SUMMARY
               ========================================== -->
          <div class="printable-section page-break">
            <h2 class="section-title">10. Overall Budget Summary</h2>
            <table class="summary-table">
              <tr>
                <td>Infrastructure Cost</td>
                <td id="sumInfra">0</td>
              </tr>
              <tr>
                <td>Development Cost</td>
                <td id="sumDev">0</td>
              </tr>
              <tr>
                <td>Maintenance Cost</td>
                <td id="sumMaint">0</td>
              </tr>
              <tr>
                <td>Risk Coverage Cost</td>
                <td id="sumRisk">0</td>
              </tr>
              <tr class="grand-total">
                <td><strong>TOTAL COST</strong></td>
                <td><strong id="grandTotal">0</strong></td>
              </tr>
            </table>
          </div>

          <!-- ==========================================
               SECTION 11: OWNERSHIP
               ========================================== -->
          <div class="printable-section">
            <h2 class="section-title">11. Ownership</h2>
            <p class="instruction-text">
              Define who owns the source code and assets upon completion.
            </p>
            <textarea class="auto-expand">
The Client shall own all rights, title, and interest in the deliverables upon full payment of the project fee. The Company retains the right to use the project for portfolio and marketing purposes unless otherwise agreed.</textarea
            >

            <table id="ownershipTable">
              <thead>
                <tr>
                  <th>Role</th>
                  <th>Name</th>
                  <th>Contact Details</th>
                  <th class="no-print">Action</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><input type="text" placeholder="Developer/Owner" /></td>
                  <td><input type="text" placeholder="Your Name" /></td>
                  <td><input type="text" placeholder="Email/Phone" /></td>
                  <td class="no-print"></td>
                </tr>
              </tbody>
            </table>
            <button
              class="no-print add-row-btn"
              onclick="addRow('ownershipTable')"
            >
              + Add Stakeholder
            </button>
          </div>

          <!-- ==========================================
               SECTION 12: COMPANY POLICY
               ========================================== -->
          <div class="printable-section">
            <h2 class="section-title">12. Company Policy</h2>
            <div id="displayPolicy" class="policy-box"></div>
          </div>

          <!-- ==========================================
               SECTION 13: AUTHORIZATION
               ========================================== -->
          <div class="printable-section">
            <h2 class="section-title">13. Authorization</h2>
            <p>
              By signing below, both parties agree to the terms and conditions
              outlined in this proposal.
            </p>

            <div class="grid-2-col signature-container">
              <div class="sig-block">
                <h3>Accepted by (Client):</h3>
                <div class="sig-space" id="clientSigDisplay">
                  <img
                    id="clientSigImg"
                    src=""
                    style="display: none; max-height: 80px"
                  />
                  <span class="placeholder-text"
                    >Signature will appear here</span
                  >
                </div>
                <div class="sig-info">
                  <input
                    type="file"
                    accept="image/*"
                    class="no-print"
                    onchange="
                      previewSignature(this, 'clientSigImg', 'clientSigDisplay')
                    "
                  />
                  <label>Signature</label>
                  <input type="text" placeholder="Full Name" />
                  <input type="text" placeholder="Position" />
                  <input type="date" />
                </div>
              </div>

              <div class="sig-block">
                <h3>Approved by (Company):</h3>
                <div class="sig-space" id="companySigDisplay">
                  <img
                    id="companySigImg"
                    src=""
                    style="display: none; max-height: 80px"
                  />
                  <span class="placeholder-text"
                    >Signature will appear here</span
                  >
                </div>
                <div class="sig-info">
                  <input
                    type="file"
                    accept="image/*"
                    class="no-print"
                    onchange="
                      previewSignature(
                        this,
                        'companySigImg',
                        'companySigDisplay',
                      )
                    "
                  />
                  <label>Signature</label>
                  <input type="text" placeholder="Full Name" />
                  <input type="text" placeholder="Position" />
                  <input type="date" />
                </div>
              </div>
            </div>
          </div>

          <!-- ==========================================
               SECTION 15: Footer Contact Information
               ========================================== -->

          <footer class="doc-footer">
            <hr />
            <p>
              For any queries or convenience, please contact:
              <span href="mailto:query.sequenceit@gmail.com" id="contactEmail"
                >query.sequenceit@gmail.com</span
              >
            </p>
          </footer>
        </div>
      </div>

      <div id="policy" class="tab-content">
        <h3>Company Policy</h3>
        <div class="config-panel" style="margin-bottom: 15px">
          <label style="display: block; font-weight: bold; margin-bottom: 6px">
            Policy Source
          </label>
          <select id="policyMode" style="margin-bottom: 10px">
            <option value="create">Create Policy</option>
            <option value="file">Choose From Files</option>
          </select>

          <div id="policyFileRow" style="display: none">
            <label
              style="display: block; font-weight: bold; margin-bottom: 6px"
            >
              Select Policy File
            </label>
            <select id="policyFile">
              <option value="sequenceit-policy.txt">
                sequenceit-policy.txt
              </option>
            </select>
          </div>
        </div>

        <textarea
          id="policyText"
          rows="20"
          style="width: 100%"
          placeholder="Write your policy here..."
        ></textarea>
      </div>

      <div id="drafts" class="tab-content">
        <div class="drafts-container">
          <div class="drafts-header">
            <h2>üìÅ Saved Drafts</h2>
            <p class="drafts-subtitle">
              Manage and edit your saved proposal drafts
            </p>
          </div>
          <div id="draftsList" class="drafts-list">
            <!-- Saved drafts will appear here -->
          </div>
        </div>
      </div>

      <div id="preview" class="tab-content">
        <!-- Preview content will be dynamically generated here -->
      </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="config.js"></script>
    <script src="script.js"></script>
    <script src="draft-manager-supabase.js"></script>
  </body>
</html>
